<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>Using MCP Servers with the Copilot SDK for Clojure</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name"></span> <span class="project-version"></span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="API.html"><div class="inner"><span>API Reference</span></div></a></li><li class="depth-1 "><a href="byok.html"><div class="inner"><span>BYOK (Bring Your Own Key)</span></div></a></li><li class="depth-1 "><a href="debugging.html"><div class="inner"><span>MCP Server Debugging Guide</span></div></a></li><li class="depth-1 "><a href="getting-started.html"><div class="inner"><span>Getting Started with the Copilot SDK for Clojure</span></div></a></li><li class="depth-1 "><a href="index.html"><div class="inner"><span>Authentication</span></div></a></li><li class="depth-1 "><a href="index.html"><div class="inner"><span>Documentation</span></div></a></li><li class="depth-1  current"><a href="overview.html"><div class="inner"><span>Using MCP Servers with the Copilot SDK for Clojure</span></div></a></li><li class="depth-1 "><a href="style.html"><div class="inner"><span>Documentation Style Guide</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>github</span></div></div></li><li class="depth-2"><a href="github.copilot-sdk.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>copilot-sdk</span></div></a></li><li class="depth-3 branch"><a href="github.copilot-sdk.client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></a></li><li class="depth-3 branch"><a href="github.copilot-sdk.helpers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>helpers</span></div></a></li><li class="depth-3 branch"><a href="github.copilot-sdk.instrument.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>instrument</span></div></a></li><li class="depth-3 branch"><a href="github.copilot-sdk.logging.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logging</span></div></a></li><li class="depth-3 branch"><a href="github.copilot-sdk.process.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>process</span></div></a></li><li class="depth-3 branch"><a href="github.copilot-sdk.protocol.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>protocol</span></div></a></li><li class="depth-3 branch"><a href="github.copilot-sdk.session.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>session</span></div></a></li><li class="depth-3 branch"><a href="github.copilot-sdk.specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-3 branch"><a href="github.copilot-sdk.tools.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tools</span></div></a></li><li class="depth-3"><a href="github.copilot-sdk.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#using-mcp-servers-with-the-copilot-sdk-for-clojure" id="using-mcp-servers-with-the-copilot-sdk-for-clojure"></a>Using MCP Servers with the Copilot SDK for Clojure</h1>
<p>The Copilot SDK can integrate with <strong>MCP servers</strong> (Model Context Protocol) to extend the assistant’s capabilities with external tools. MCP servers run as separate processes and expose tools (functions) that Copilot can invoke during conversations.</p>
<h2><a href="#what-is-mcp" id="what-is-mcp"></a>What is MCP?</h2>
<p><a href="https://modelcontextprotocol.io/">Model Context Protocol (MCP)</a> is an open standard for connecting AI assistants to external tools and data sources. MCP servers can:</p>
<ul>
<li>Execute code or scripts</li>
<li>Query databases</li>
<li>Access file systems</li>
<li>Call external APIs</li>
<li>And much more</li>
</ul>
<h2><a href="#server-types" id="server-types"></a>Server Types</h2>
<p>The SDK supports two types of MCP servers:</p>
<table>
<thead>
<tr><th> Type </th><th> Description </th><th> Use Case </th></tr>
</thead>
<tbody>
<tr><td> <strong>Local/Stdio</strong> (<code>:local</code>, <code>:stdio</code>) </td><td> Runs as a subprocess, communicates via stdin/stdout </td><td> Local tools, file access, custom scripts </td></tr>
<tr><td> <strong>HTTP/SSE</strong> (<code>:http</code>, <code>:sse</code>) </td><td> Remote server accessed via HTTP </td><td> Shared services, cloud-hosted tools </td></tr>
</tbody>
</table>
<h2><a href="#configuration" id="configuration"></a>Configuration</h2>
<h3><a href="#local-mcp-server" id="local-mcp-server"></a>Local MCP Server</h3>
<pre><code class="language-clojure">(require '[github.copilot-sdk :as copilot])
(require '[github.copilot-sdk.helpers :as h])

(copilot/with-client-session [session
                              {:model "gpt-5.2"
                               :mcp-servers
                               {"my-local-server"
                                {:mcp-command "node"
                                 :mcp-args ["./mcp-server.js"]
                                 :mcp-tools ["*"]
                                 :env {"DEBUG" "true"}
                                 :cwd "./servers"}}}]
  (println (h/query "Use my tools to help me" :session session)))
</code></pre>
<h3><a href="#remote-mcp-server-http" id="remote-mcp-server-http"></a>Remote MCP Server (HTTP)</h3>
<pre><code class="language-clojure">(copilot/with-client-session [session
                              {:model "gpt-5.2"
                               :mcp-servers
                               {"github"
                                {:mcp-server-type :http
                                 :mcp-url "https://api.githubcopilot.com/mcp/"
                                 :mcp-headers {"Authorization" (str "Bearer " token)}
                                 :mcp-tools ["*"]}}}]
  (println (h/query "List my recent GitHub notifications" :session session)))
</code></pre>
<h3><a href="#multiple-mcp-servers" id="multiple-mcp-servers"></a>Multiple MCP Servers</h3>
<p>You can combine multiple MCP servers in a single session:</p>
<pre><code class="language-clojure">(copilot/with-client-session [session
                              {:model "gpt-5.2"
                               :mcp-servers
                               {"filesystem"
                                {:mcp-command "npx"
                                 :mcp-args ["-y" "@modelcontextprotocol/server-filesystem" "/tmp"]
                                 :mcp-tools ["*"]}
                                "github"
                                {:mcp-server-type :http
                                 :mcp-url "https://api.githubcopilot.com/mcp/"
                                 :mcp-headers {"Authorization" (str "Bearer " token)}
                                 :mcp-tools ["*"]}}}]
  ;; Both servers' tools are available
  (println (h/query "List files in /tmp and my GitHub notifications" :session session)))
</code></pre>
<h2><a href="#quick-start-filesystem-mcp-server" id="quick-start-filesystem-mcp-server"></a>Quick Start: Filesystem MCP Server</h2>
<p>Here’s a complete working example using the official <a href="https://www.npmjs.com/package/@modelcontextprotocol/server-filesystem"><code>@modelcontextprotocol/server-filesystem</code></a> MCP server:</p>
<pre><code class="language-clojure">(require '[github.copilot-sdk :as copilot])
(require '[github.copilot-sdk.helpers :as h])

(copilot/with-client-session [session
                              {:model "gpt-5.2"
                               :mcp-servers
                               {"filesystem"
                                {:mcp-command "npx"
                                 :mcp-args ["-y" "@modelcontextprotocol/server-filesystem" "/tmp"]
                                 :mcp-tools ["*"]}}}]
  (println (h/query "List the files in the allowed directory" :session session)))
</code></pre>
<blockquote>
<p><strong>Tip:</strong> You can use any MCP server from the <a href="https://github.com/modelcontextprotocol/servers">MCP Servers Directory</a>. Popular options include <code>@modelcontextprotocol/server-github</code>, <code>@modelcontextprotocol/server-sqlite</code>, and <code>@modelcontextprotocol/server-puppeteer</code>.</p>
</blockquote>
<h2><a href="#configuration-options" id="configuration-options"></a>Configuration Options</h2>
<h3><a href="#localstdio-server" id="localstdio-server"></a>Local/Stdio Server</h3>
<table>
<thead>
<tr><th> Key </th><th> Type </th><th> Required </th><th> Description </th></tr>
</thead>
<tbody>
<tr><td> <code>:mcp-command</code> </td><td> string </td><td> Yes </td><td> Command to execute </td></tr>
<tr><td> <code>:mcp-args</code> </td><td> vector </td><td> Yes </td><td> Command arguments </td></tr>
<tr><td> <code>:mcp-tools</code> </td><td> vector </td><td> Yes </td><td> Tools to enable (<code>["*"]</code> for all, <code>[]</code> for none, or specific tool names) </td></tr>
<tr><td> <code>:mcp-server-type</code> </td><td> keyword </td><td> No </td><td> <code>:local</code> or <code>:stdio</code> (defaults to local) </td></tr>
<tr><td> <code>:mcp-timeout</code> </td><td> number </td><td> No </td><td> Timeout in milliseconds </td></tr>
<tr><td> <code>:env</code> </td><td> map </td><td> No </td><td> Environment variables for the subprocess </td></tr>
<tr><td> <code>:cwd</code> </td><td> string </td><td> No </td><td> Working directory for the subprocess </td></tr>
</tbody>
</table>
<h3><a href="#remote-server-httpsse" id="remote-server-httpsse"></a>Remote Server (HTTP/SSE)</h3>
<table>
<thead>
<tr><th> Key </th><th> Type </th><th> Required </th><th> Description </th></tr>
</thead>
<tbody>
<tr><td> <code>:mcp-server-type</code> </td><td> keyword </td><td> Yes </td><td> <code>:http</code> or <code>:sse</code> </td></tr>
<tr><td> <code>:mcp-url</code> </td><td> string </td><td> Yes </td><td> Server URL </td></tr>
<tr><td> <code>:mcp-tools</code> </td><td> vector </td><td> Yes </td><td> Tools to enable (<code>["*"]</code> for all) </td></tr>
<tr><td> <code>:mcp-timeout</code> </td><td> number </td><td> No </td><td> Timeout in milliseconds </td></tr>
<tr><td> <code>:mcp-headers</code> </td><td> map </td><td> No </td><td> HTTP headers (e.g., for authentication) </td></tr>
</tbody>
</table>
<h3><a href="#key-naming-convention" id="key-naming-convention"></a>Key Naming Convention</h3>
<p>MCP server config keys use an <code>:mcp-</code> prefix in Clojure (e.g., <code>:mcp-command</code>, <code>:mcp-args</code>, <code>:mcp-tools</code>) to distinguish them from other configuration options. On the wire, the SDK automatically strips this prefix to match the upstream protocol (e.g., <code>command</code>, <code>args</code>, <code>tools</code>).</p>
<p>The non-prefixed keys <code>:env</code> and <code>:cwd</code> are shared with other config types and do not have an <code>:mcp-</code> prefix.</p>
<h2><a href="#tool-filtering" id="tool-filtering"></a>Tool Filtering</h2>
<p>Control which tools from an MCP server are available to the model:</p>
<pre><code class="language-clojure">;; All tools
{:mcp-tools ["*"]}

;; No tools (server connected but tools disabled)
{:mcp-tools []}

;; Specific tools only
{:mcp-tools ["read_file" "write_file" "list_directory"]}
</code></pre>
<h2><a href="#combining-mcp-servers-with-custom-tools" id="combining-mcp-servers-with-custom-tools"></a>Combining MCP Servers with Custom Tools</h2>
<p>MCP server tools work alongside custom tools defined with <code>define-tool</code>:</p>
<pre><code class="language-clojure">(def my-tool
  (copilot/define-tool "my_custom_tool"
    {:description "A custom tool"
     :parameters {:type "object"
                  :properties {:input {:type "string"}}
                  :required ["input"]}
     :handler (fn [args _] (copilot/result-success (str "Processed: " (:input args))))}))

(copilot/with-client-session [session
                              {:model "gpt-5.2"
                               :tools [my-tool]
                               :mcp-servers
                               {"filesystem"
                                {:mcp-command "npx"
                                 :mcp-args ["-y" "@modelcontextprotocol/server-filesystem" "/tmp"]
                                 :mcp-tools ["*"]}}}]
  ;; Both MCP tools and custom tools are available
  )
</code></pre>
<h2><a href="#troubleshooting" id="troubleshooting"></a>Troubleshooting</h2>
<p>See the <a href="./debugging.html">MCP Debugging Guide</a> for detailed troubleshooting.</p>
<h3><a href="#common-issues" id="common-issues"></a>Common Issues</h3>
<table>
<thead>
<tr><th> Issue </th><th> Solution </th></tr>
</thead>
<tbody>
<tr><td> Tools not showing up </td><td> Verify <code>:mcp-tools</code> is <code>["*"]</code> or lists specific tools </td></tr>
<tr><td> Server not starting </td><td> Check command path, use absolute paths when in doubt </td></tr>
<tr><td> Connection refused (HTTP) </td><td> Check URL and ensure the server is running </td></tr>
<tr><td> Timeout errors </td><td> Increase <code>:mcp-timeout</code> or check server performance </td></tr>
<tr><td> Tools work but aren’t called </td><td> Make your prompt clearly require the tool’s functionality </td></tr>
</tbody>
</table>
<h2><a href="#related-resources" id="related-resources"></a>Related Resources</h2>
<ul>
<li><a href="https://modelcontextprotocol.io/">Model Context Protocol Specification</a></li>
<li><a href="https://github.com/modelcontextprotocol/servers">MCP Servers Directory</a> — Community MCP servers</li>
<li><a href="https://github.com/github/github-mcp-server">GitHub MCP Server</a> — Official GitHub MCP server</li>
<li><a href="./debugging.html">MCP Debugging Guide</a> — Detailed MCP troubleshooting</li>
<li><a href="../getting-started.html">Getting Started Guide</a> — SDK basics and custom tools</li>
</ul>
</div></div></div></body></html>